var db = require('dbHelper');
var login = function(userId,password,onSuccess,onFailure){
	db.query("select * from user where id='"+userId+"' and password='"+password+"'",function(error,results){
		if(error || results.length==0){
			onFailure();
		}else{
			onSuccess();
		}
	});
}


var createUserTable = function(){
	db.query("create table user(\n id varchar(50),\n password varchar(20),\n lastName varchar(20),\n firstName varchar(20),\n suffix varchar(10),\n description varchar(200),\nprimary key (id)\n)",function(error,results){});
}


var createUser = function(userId,password,onSuccess,onFailure){
	db.query("insert into user(id,password) values('"+userId+"','"+password+"')",function(error,results){
		if(error){
			onFailure();
		}else{
			onSuccess();
		}
	});
}


var setProfile = function(userId,lastName,firstName,suffix,description,onSuccess,onFailure){
	db.query("update user set lastName='"+lastName+"',firstName='"+firstName+"',suffix='"+suffix+"',description='"+description+"' where id='"+userId+"'",function(error,results){
		if(error){
			onFailure();
		}else{
			onSuccess();
		}
	});
}


var getProfile = function(userId,onSuccess,onFailure){
	db.query("select lastName,firstName,suffix,description from user where id='"+userId+"'",function(error,results){
		if(error){
			onFailure();
		}else{
			onSuccess(results[0]['lastName'],results[0]['firstName'],results[0]['suffix'],results[0]['description']);
		}
	});
}
exports.getProfile = getProfile;
exports.login = login;
exports.createUser = createUser;
exports.setProfile = setProfile;
